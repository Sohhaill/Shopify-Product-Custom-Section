<style>
    .page-width-desktop {
    max-width: 1200px;
    padding: 0 16px;
    margin: auto;
}

.sh_all_product {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    gap: 20px;
}

.sh_each_product {
    position: relative;
}

img.sh_plus_icon {
    position: absolute;
    bottom: 31%;
    right: 11%;
    cursor: pointer;
}

h1.sh_product_section_title {
    font-size: 36px;
    font-weight: 400;
    line-height: 120%;
    margin-bottom: 30px;
}
.sh_close img{
    cursor: pointer;;
}

.sh_product_section .black_btn_mobile {
    background: black;
    border: unset;
    width: 100%;
    color: white;
    font-size: 16px;
    height: 45px;
    text-transform: uppercase;
    text-align: center;
    font-weight: 400;
    transition: all 0.3s ease-in-out;
    margin-top: 60px;
    align-self: center;
}



.sh_product_popup {
    width: 311px;
    padding: 25px 17px;
    background: white;
    display: flex
;
    flex-direction: column;
}
.varient_size {
    margin-top: 11px;
}


.sh_popup_main {
     display: none;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0,0,0,0.6); 
  z-index: 9999;
    justify-content: center;
    align-items: center;
    padding: 20px;
}

.sh_product_popup {
    width: 311px;
    padding: 25px 17px;
    background: white;
}

.sh_close {
    display: flex;
    justify-content: end;
    margin-bottom: 10px;
}

img.sh_popup_image {
    width: 120px;
    height: 140px;
    object-fit: cover;
}

.sh_product_info {
    display: flex;
    align-items: flex-start;
    gap: 8px;
    margin-bottom: 7px;
}

p.sh_title {
    font-size: 16px;
    font-weight: 300;
    line-height: 120%;
    margin-top: 7px;
    margin-bottom: 20px;
}

p.sh_price {
    font-size: 16px;
    font-weight: 400;
    margin-bottom: 12px;
}

p.sh_description {
    font-size: 14px;
    line-height: 110%;
    font-weight: 300;
}
.sh_varient_name {
    font-size: 14px;
    font-weight: 400;
    margin-bottom: 5px;
    color: #333333;
}
.each_color_varient {
    display: flex
;
    align-items: center;
    gap: 11px;
    width: 50%;
}
.sh_color {
    width: 5px;
    height: 40px;
    border: 1px solid black;
    background: white;
}
p.sh_color_text {
    font-size: 18px;
    font-weight: 400;
  margin:unset !important;
}
.colorsh_all {
    border-top: 1px solid #00000059;
    border-bottom: 1px solid #00000059;
    display: flex
;
    border-right: 1px solid #00000059;
    justify-content: start;
    flex-wrap: wrap;
}
.sh_sizes {
    display: flex
;
    justify-content: space-between;
    height: 40px;
    border: 1px solid #00000059;
    align-items: center;
    padding: 0px 13px;
}
.sh_choose_size p {
    font-size: 16px;
    font-weight: 400;
}
.size_dropdown_sh {
    border-left: 1px solid #00000059;
    height: 100%;
    display: flex
;
    justify-content: center;
    align-items: center;
    padding-left: 16px;
}
.sizedrop {
    border: 1px solid black;
    padding: 6px 0px;
    text-align: center;
}
.eachoptionsize_sh {
    padding: 5px 0px;
color: black;
transition: all .3s ease-in-out;
}
.eachoptionsize_sh:hover {
color: white;
background-color: black;
}
.sizedrop{
    display: none;
}
.each_color_varient.selected,
.eachoptionsize_sh.selected {
  background: black;
  color: white;
}
</style>




<style>
  .each_color_varient.active,
  .eachoptionsize_sh.active {
    border: 2px solid black;
    background-color: #f0f0f0;
  }

</style>

<section class="sh_product_section">
  <div class="page-width-desktop">
    <h1 class="sh_product_section_title">Tisso vision in the wild</h1>
    <div class="sh_all_product">
      {% for block in section.blocks %}
        {% assign product = all_products[block.settings.sh_product] %}
        {% if product %}
        <div class="sh_each_product" data-product-id="{{ product.id }}">
          <img class="sh_product_image" src="{{ product.featured_image | img_url: 'medium' }}" alt="{{ product.title }}">
          <img class="sh_plus_icon" src="https://cdn.shopify.com/s/files/1/0949/3331/9998/files/Group_1000008190.png?v=1749920143" width="22" data-product-id="{{ product.id }}">
        </div>

        <!-- Product Popup -->
        <div class="sh_popup_main" id="popup-{{ product.id }}" data-product='{{ product | json | escape }}'>
          <div class="sh_product_popup">
            <div class="sh_close">
              <img src="https://cdn.shopify.com/s/files/1/0949/3331/9998/files/Group_1000008134.png?v=1749920143" width="12">
            </div>
            <div class="sh_product_info">
              <img class="sh_popup_image" src="{{ product.featured_image | img_url: 'medium' }}" alt="{{ product.title }}">
              <div class="sh_product_title">
                <p class="sh_title">{{ product.title }}</p>
                <p class="sh_price">{{ product.price | money }}</p>
                <p class="sh_description">{{ product.description | strip_html | truncatewords: 20 }}</p>
              </div>
            </div>

            <!-- Color Variant -->
            <div class="varient_color">
              <div class="sh_varient_name">Color</div>
              <div class="colorsh_all">
                {% for option in product.options_with_values %}
                  {% if option.name == 'Color' %}
                    {% for value in option.values %}
                      <div class="each_color_varient" data-color="{{ value }}">
                        <div class="sh_color"></div>
                        <p class="sh_color_text">{{ value }}</p>
                      </div>
                    {% endfor %}
                  {% endif %}
                {% endfor %}
              </div>
            </div>

            <!-- Size Variant -->
            <div class="varient_size">
              <div class="sh_varient_name">Size</div>
              <div class="sh_sizes">
                <div class="sh_choose_size"><p>Choose your size</p></div>
                <div class="size_dropdown_sh">
                  <img src="https://cdn.shopify.com/s/files/1/0949/3331/9998/files/Vector.png?v=1749920143" width="12">
                </div>
              </div>
              <div class="sizedrop">
                {% for option in product.options_with_values %}
                  {% if option.name == 'Size' %}
                    {% for value in option.values %}
                      <div class="eachoptionsize_sh" data-size="{{ value }}">{{ value }}</div>
                    {% endfor %}
                  {% endif %}
                {% endfor %}
              </div>
            </div>

            <!-- Add to Cart -->
            <form method="post" action="/cart/add">
              <input type="hidden" name="id" class="variant_id_input" value="">
              <button type="submit" class="black_btn_mobile">Add to cart â†’</button>
            </form>
          </div>
        </div>
        {% endif %}
      {% endfor %}
    </div>
  </div>
</section>

<script>
  document.querySelectorAll('.sh_plus_icon').forEach(icon => {
    icon.addEventListener('click', () => {
      const productId = icon.getAttribute('data-product-id');
      document.querySelectorAll('.sh_popup_main').forEach(popup => popup.style.display = 'none');
      document.getElementById('popup-' + productId).style.display = 'flex';
    });
  });

  document.querySelectorAll('.sh_close').forEach(btn => {
    btn.addEventListener('click', () => {
      btn.closest('.sh_popup_main').style.display = 'none';
    });
  });

  document.querySelectorAll('.sh_popup_main').forEach(popup => {
    let selectedColor = '';
    let selectedSize = '';

    const productData = JSON.parse(popup.getAttribute('data-product'));
    const variantInput = popup.querySelector('.variant_id_input');

    popup.querySelectorAll('.each_color_varient').forEach(el => {
      el.addEventListener('click', () => {
        popup.querySelectorAll('.each_color_varient').forEach(e => e.classList.remove('active'));
        el.classList.add('active');
        selectedColor = el.getAttribute('data-color');
        updateVariant();
      });
    });

    popup.querySelectorAll('.eachoptionsize_sh').forEach(el => {
      el.addEventListener('click', () => {
        popup.querySelectorAll('.eachoptionsize_sh').forEach(e => e.classList.remove('active'));
        el.classList.add('active');
        selectedSize = el.getAttribute('data-size');
        updateVariant();
      });
    });

    popup.querySelector('.sh_sizes').addEventListener('click', () => {
      const sizedropEl = popup.querySelector('.sizedrop');
      const icon = popup.querySelector('.size_dropdown_sh img');
      const isOpen = sizedropEl.style.display === 'block';
      document.querySelectorAll('.sizedrop').forEach(e => e.style.display = 'none');
      document.querySelectorAll('.size_dropdown_sh img').forEach(i => i.style.transform = 'rotate(0deg)');
      if (!isOpen) {
        sizedropEl.style.display = 'block';
        icon.style.transform = 'rotate(180deg)';
      }
    });

    function updateVariant() {
      const matchedVariant = productData.variants.find(v =>
        v.options.includes(selectedColor) && v.options.includes(selectedSize)
      );

      if (matchedVariant) {
        variantInput.value = matchedVariant.id;
      } else {
        variantInput.value = '';
      }
    }
  });
</script>





{% schema %}
{
  "name": "Popup Product Section",
  "settings": [
  {
      "type": "text",
      "id": "product_section_title",
      "label": "Tisso vision in the wild",
      "default": "Tisso vision in the wild"
    },

  ],
  "blocks": [
    {
      "type": "product_block",
      "name": "Product",
      "settings": [
        {
          "type": "product",
          "id": "sh_product",
          "label": "Select Product"
        }
      ]
    }
  ],
  "max_blocks": 10,
  "presets": [
    {
      "name": "Product Popup Section",
      "blocks": []
    }
  ]
}
{% endschema %}


